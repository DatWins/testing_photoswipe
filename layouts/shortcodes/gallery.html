<!--
Put this file in /layouts/shortcodes/gallery.html
Documentation and licence at https://github.com/thkukuk/hugo-easy-gallery/
-->

<!-- count how many times we've called this shortcode; load the css if it's the first time -->
{{- if not ($.Page.Scratch.Get "figurecount") -}}<link rel="stylesheet" href={{ "assets/css/hugo-easy-gallery.css" | relURL }}>{{- end }}
{{- $.Page.Scratch.Add "figurecount" 1 -}}
{{- $baseURL := .Site.BaseURL -}}
{{- $thumbnailSize := .Get "thumbnail-size" | default "300x300" -}}
<div class="gallery caption-position-{{ with .Get "caption-position" | default "bottom" }}{{.}}{{end}} caption-effect-{{ with .Get "caption-effect" | default "slide" }}{{.}}{{end}} hover-effect-{{ with .Get "hover-effect" | default "zoom" }}{{.}}{{end}} {{ if ne (.Get "hover-transition") "none" }}hover-transition{{end}}" itemscope itemtype="http://schema.org/ImageGallery">
    <div class="pswp-gallery pswp-gallery--single-column" id="photoswipe5-gallery">
    {{- with (.Get "dir") -}}
        <!-- Generate figures for all page resources of type image. -->
	{{- range $.Page.Resources.ByType "image" }}
	    {{- $thumbnail := .Fill $thumbnailSize -}}
            <div class="box" style="max-width: {{ .Width }}px;">
            <figure itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
                <div class="img" style="background-image: url('{{ $thumbnail.RelPermalink }}');" >
                    <a href="{{ .RelPermalink }}"
                        data-pswp-width="{{ .Width }}"
                        data-pswp-height="{{ .Height }}"
                        target="_blank">
                        <img src="{{- $thumbnail.RelPermalink -}}" width="{{ $thumbnail.Width }}" height="{{ $thumbnail.Height }}" alt="{{ .Title }}">
			<span class="pswp-caption-content">{{ .Title }}</span>
                    </a>
                    {{- with .Title }}
                    <figcaption>
                        <p>{{ . }}</p>
                    </figcaption>
                    {{- end }}
                </div>
            </figure>
            </div>
	{{end }}
    {{- end }}
    {{- with .Inner -}}
        <!-- If no directory was specified, include any figure shortcodes called within the gallery -->
        {{ . }}
    {{- end -}}
    </div>
</div>
